{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Siddharth.S.Chandran\\\\Desktop\\\\MyProjects\\\\smartshoplatest\\\\src\\\\components\\\\razorpay.js\",\n    _s = $RefreshSig$();\n\nimport { React, useEffect, useState } from 'react';\nimport { db } from '../firebase/firebase';\nimport swal from 'sweetalert';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst RazorPanel = ({\n  price,\n  items,\n  uid\n}) => {\n  _s();\n\n  const [amount, setAmount] = useState(price);\n\n  const addToSales = async items => {\n    const citiesRef = db.collection('Item sales');\n    const snapshot = await citiesRef.get();\n    var isAlreadyPresent = 0;\n    snapshot.forEach(doc => {\n      var data = {\n        item_code: doc.data().item_code,\n        product: doc.data().product,\n        quantity: doc.data().quantity,\n        revenue: doc.data().revenue\n      };\n      items.map(async item => {\n        if (item.item_code === data.item_code) {\n          var data_new = {\n            item_code: item.item_code,\n            product: items.product,\n            quantity: item.quantity + data.quantity,\n            revenue: item.price + data.revenue\n          };\n          const res = await db.collection('Item sales').doc(String(data_new.item_code)).set(data_new);\n          isAlreadyPresent = 1;\n        }\n      });\n    });\n\n    if (isAlreadyPresent === 0) {\n      items.map(async item => {\n        var data_new = {\n          item_code: item.item_code,\n          product: item.product,\n          quantity: item.quantity,\n          revenue: item.price\n        };\n        const res = await db.collection('Item sales').doc(String(data_new.item_code)).set(data_new);\n      });\n    }\n  };\n\n  const openCheckout = () => {\n    let options = {\n      \"key\": \"rzp_test_myGwLTueUSTDxn\",\n      \"amount\": price,\n      // 2000 paise = INR 20, amount in paisa\n      \"name\": \"Smart shop\",\n      \"description\": \"Purchase Description\",\n      \"image\": \"./logo.png\",\n      \"handler\": function (response) {\n        alert(response.razorpay_payment_id); //add to billing master \n\n        items.map(async item => {\n          var data = {\n            customer_id: uid,\n            item_code: item.item_code,\n            price: item.price,\n            product: item.product,\n            quantity: item.quantity,\n            sales_id: response.razorpay_payment_id\n          };\n          const ref = db.collection('branch item master').doc(String(item.item_code));\n          const document = await ref.get();\n          console.log(document.data().quantity_received);\n          var data1 = {\n            item_code: item.item_code,\n            price: item.price,\n            product: item.product,\n            quantity_received: document.data().quantity_received,\n            quantity_remaining: document.data().quantity_remaining - item.quantity\n          };\n          console.log(item.doc_id);\n          const res = await db.collection('billing master').add(data);\n          const res1 = await db.collection('Cart').doc(String(item.doc_id)).delete();\n          const res2 = await db.collection('branch item master').doc(String(item.item_code)).set(data1);\n        });\n        addToSales(items);\n      },\n      \"prefill\": {\n        \"name\": \"\",\n        \"email\": \"\"\n      },\n      \"notes\": {\n        \"address\": \"Hello World\"\n      },\n      \"theme\": {\n        \"color\": \"#47A8BD\"\n      }\n    };\n    let rzp = new window.Razorpay(options);\n    rzp.open();\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: /*#__PURE__*/_jsxDEV(\"button\", {\n      class: \"btn transparent\",\n      style: {\n        background: \"#6CB4EE\"\n      },\n      id: \"rzp-button1\",\n      onClick: () => openCheckout(),\n      children: \"Pay\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 5\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 106,\n    columnNumber: 10\n  }, this);\n};\n\n_s(RazorPanel, \"Mj+UCR+o4jUC3cLp4SZy/LtB8to=\");\n\n_c = RazorPanel;\nexport default RazorPanel;\n\nvar _c;\n\n$RefreshReg$(_c, \"RazorPanel\");","map":{"version":3,"sources":["C:/Users/Siddharth.S.Chandran/Desktop/MyProjects/smartshoplatest/src/components/razorpay.js"],"names":["React","useEffect","useState","db","swal","RazorPanel","price","items","uid","amount","setAmount","addToSales","citiesRef","collection","snapshot","get","isAlreadyPresent","forEach","doc","data","item_code","product","quantity","revenue","map","item","data_new","res","String","set","openCheckout","options","response","alert","razorpay_payment_id","customer_id","sales_id","ref","document","console","log","quantity_received","data1","quantity_remaining","doc_id","add","res1","delete","res2","rzp","window","Razorpay","open","background"],"mappings":"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","sourcesContent":["import { React, useEffect, useState } from 'react';\nimport { db } from '../firebase/firebase';\n\nimport swal from 'sweetalert';\nconst RazorPanel = ({ price, items, uid }) => {\n  \n  const [amount, setAmount] = useState(price);\n\n\n  const addToSales = async(items) => {\n\n    const citiesRef = db.collection('Item sales');\n    const snapshot = await citiesRef.get();\n\n    var isAlreadyPresent = 0;\n\n    snapshot.forEach(doc => {\n\n      var data = {\n        item_code: doc.data().item_code,\n        product: doc.data().product,\n        quantity: doc.data().quantity,\n        revenue: doc.data().revenue\n      }\n\n      items.map(async (item) => {\n        if (item.item_code === data.item_code) {\n          var data_new = {\n            item_code: item.item_code,\n            product: items.product,\n            quantity: item.quantity + data.quantity,\n            revenue: item.price + data.revenue\n          }\n          const res = await db.collection('Item sales').doc(String(data_new.item_code)).set(data_new);\n          isAlreadyPresent = 1;\n        }\n      });\n\n    });\n\n    if(isAlreadyPresent === 0)\n    {\n      items.map(async(item) => {\n        var data_new = {\n          item_code: item.item_code,\n          product: item.product,\n          quantity: item.quantity,\n          revenue: item.price\n        }\n        const res = await db.collection('Item sales').doc(String(data_new.item_code)).set(data_new);\n      });\n    }\n  }\n\n  const openCheckout = () => {\n    let options = {\n      \"key\": \"rzp_test_myGwLTueUSTDxn\",\n      \"amount\": price, // 2000 paise = INR 20, amount in paisa\n      \"name\": \"Smart shop\",\n      \"description\": \"Purchase Description\",\n      \"image\": \"./logo.png\",\n      \"handler\": function (response) {\n        alert(response.razorpay_payment_id);\n        //add to billing master \n        items.map(async (item) => {\n          var data = {\n            customer_id: uid,\n            item_code: item.item_code,\n            price: item.price,\n            product: item.product,\n            quantity: item.quantity,\n            sales_id: response.razorpay_payment_id\n          };\n          const ref = db.collection('branch item master').doc(String(item.item_code));\n          const document = await ref.get();\n          console.log(document.data().quantity_received);\n          var data1 = {\n            item_code: item.item_code,\n            price: item.price,\n            product: item.product,\n            quantity_received: document.data().quantity_received,\n            quantity_remaining: document.data().quantity_remaining - item.quantity\n          };\n          console.log(item.doc_id);\n          const res = await db.collection('billing master').add(data);\n          const res1 = await db.collection('Cart').doc(String(item.doc_id)).delete();\n          const res2 = await db.collection('branch item master').doc(String(item.item_code)).set(data1);\n        })\n        addToSales(items);\n      },\n      \"prefill\": {\n        \"name\": \"\",\n        \"email\": \"\"\n      },\n      \"notes\": {\n        \"address\": \"Hello World\"\n      },\n      \"theme\": {\n        \"color\": \"#47A8BD\"\n      }\n    };\n\n    let rzp = new window.Razorpay(options);\n    rzp.open();\n  }\n  return <div>\n\n    <button class=\"btn transparent\" style={{ background: \"#6CB4EE\" }} id=\"rzp-button1\" onClick={() => openCheckout()}>\n      Pay\n      </button>\n  </div>\n\n}\nexport default RazorPanel;\n"]},"metadata":{},"sourceType":"module"}