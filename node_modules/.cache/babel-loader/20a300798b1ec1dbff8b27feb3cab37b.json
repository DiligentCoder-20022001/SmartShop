{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Siddharth.S.Chandran\\\\Desktop\\\\MyProjects\\\\smartshoplatest\\\\src\\\\components\\\\razorpay.js\",\n    _s = $RefreshSig$();\n\nimport { React, useEffect, useState } from 'react';\nimport { db } from '../firebase/firebase';\nimport swal from 'sweetalert';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst RazorPanel = ({\n  price,\n  items,\n  uid\n}) => {\n  _s();\n\n  const [amount, setAmount] = useState(price);\n\n  const addToSales = async () => {\n    const citiesRef = db.collection('Item sales');\n    const snapshot = await citiesRef.get();\n    var isAlreadyPresent = 0;\n    snapshot.forEach(doc => {\n      var data = {\n        item_code: doc.data().item_code,\n        product: doc.data().product,\n        quantity: doc.data().quantity,\n        revenue: doc.data().revenue\n      };\n      items.map(async item => {\n        if (item.item_code === data.item_code) {\n          var data_new = {\n            item_code: item.item_code,\n            product: item.product,\n            quantity: parseInt(item.quantity + data.quantity),\n            revenue: parseInt(item.price + data.revenue)\n          };\n          console.log(data_new);\n          const res = await db.collection('Item sales').doc(String(data_new.item_code)).set(data_new).catch(err => console.log(err));\n          isAlreadyPresent = 1;\n        }\n      });\n    });\n\n    if (isAlreadyPresent === 0) {\n      items.map(async item => {\n        var data_new = {\n          item_code: item.item_code,\n          product: item.product,\n          quantity: item.quantity,\n          revenue: item.price\n        };\n        const res = await db.collection('Item sales').doc(String(data_new.item_code)).set(data_new).catch(err => console.log(err));\n      });\n    }\n  };\n\n  const openCheckout = () => {\n    let options = {\n      \"key\": \"rzp_test_myGwLTueUSTDxn\",\n      \"amount\": price,\n      // 2000 paise = INR 20, amount in paisa\n      \"name\": \"Smart shop\",\n      \"description\": \"Purchase Description\",\n      \"image\": \"https://cdn.razorpay.com/logos/H7uqY0rDp7E5mn_medium.png\",\n      \"handler\": function (response) {\n        swal({\n          title: \"Good job!\",\n          text: \"Payment successful, please refresh the page!\",\n          icon: \"success\",\n          button: \"Proceed!\"\n        }); //add to billing master \n\n        items.map(async item => {\n          var data = {\n            customer_id: uid,\n            item_code: item.item_code,\n            price: item.price,\n            product: item.product,\n            quantity: item.quantity,\n            sales_id: response.razorpay_payment_id\n          };\n          const ref = db.collection('branch item master').doc(String(item.item_code));\n          const document = await ref.get();\n          console.log(document.data().quantity_received);\n          var data1 = {\n            item_code: item.item_code,\n            price: item.price,\n            product: item.product,\n            quantity_received: document.data().quantity_received,\n            quantity_remaining: document.data().quantity_remaining - item.quantity\n          };\n          console.log(data);\n          console.log(data1);\n          console.log(item.doc_id);\n          const ref1 = db.collection('billing master').doc();\n          const res = ref1.set(data);\n          const res1 = await db.collection('Cart').doc(String(item.doc_id)).delete();\n          const res2 = await db.collection('branch item master').doc(String(item.item_code)).set(data1);\n        });\n        addToSales(items);\n      },\n      \"prefill\": {\n        \"name\": \"\",\n        \"email\": \"\"\n      },\n      \"notes\": {\n        \"address\": \"Hello World\"\n      },\n      \"theme\": {\n        \"color\": \"#47A8BD\"\n      }\n    };\n    let rzp = new window.Razorpay(options);\n    rzp.open();\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: /*#__PURE__*/_jsxDEV(\"button\", {\n      class: \"btn transparent\",\n      style: {\n        background: \"#6CB4EE\"\n      },\n      id: \"rzp-button1\",\n      onClick: () => openCheckout(),\n      children: \"Pay\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 5\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 116,\n    columnNumber: 10\n  }, this);\n};\n\n_s(RazorPanel, \"Mj+UCR+o4jUC3cLp4SZy/LtB8to=\");\n\n_c = RazorPanel;\nexport default RazorPanel;\n\nvar _c;\n\n$RefreshReg$(_c, \"RazorPanel\");","map":{"version":3,"sources":["C:/Users/Siddharth.S.Chandran/Desktop/MyProjects/smartshoplatest/src/components/razorpay.js"],"names":["React","useEffect","useState","db","swal","RazorPanel","price","items","uid","amount","setAmount","addToSales","citiesRef","collection","snapshot","get","isAlreadyPresent","forEach","doc","data","item_code","product","quantity","revenue","map","item","data_new","parseInt","console","log","res","String","set","catch","err","openCheckout","options","response","title","text","icon","button","customer_id","sales_id","razorpay_payment_id","ref","document","quantity_received","data1","quantity_remaining","doc_id","ref1","res1","delete","res2","rzp","window","Razorpay","open","background"],"mappings":"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","sourcesContent":["import { React, useEffect, useState } from 'react';\nimport { db } from '../firebase/firebase';\n\nimport swal from 'sweetalert';\nconst RazorPanel = ({ price, items, uid }) => {\n  \n  const [amount, setAmount] = useState(price);\n\n\n  const addToSales = async() => {\n\n    const citiesRef = db.collection('Item sales');\n    const snapshot = await citiesRef.get();\n\n    var isAlreadyPresent = 0;\n\n    snapshot.forEach(doc => {\n\n      var data = {\n        item_code: doc.data().item_code,\n        product: doc.data().product,\n        quantity: doc.data().quantity,\n        revenue: doc.data().revenue\n      }\n\n      items.map(async (item) => {\n        if (item.item_code === data.item_code) {\n          var data_new = {\n            item_code: item.item_code,\n            product: item.product,\n            quantity: parseInt(item.quantity + data.quantity),\n            revenue: parseInt(item.price + data.revenue)\n          }\n          console.log(data_new);\n          const res = await db.collection('Item sales').doc(String(data_new.item_code)).set(data_new).catch(err => console.log(err));\n          isAlreadyPresent = 1;\n        }\n      });\n\n    });\n\n    if(isAlreadyPresent === 0)\n    {\n      items.map(async(item) => {\n        var data_new = {\n          item_code: item.item_code,\n          product: item.product,\n          quantity: item.quantity,\n          revenue: item.price\n        }\n        const res = await db.collection('Item sales').doc(String(data_new.item_code)).set(data_new).catch(err => console.log(err));\n      });\n    }\n  }\n\n  const openCheckout = () => {\n    let options = {\n      \"key\": \"rzp_test_myGwLTueUSTDxn\",\n      \"amount\": price, // 2000 paise = INR 20, amount in paisa\n      \"name\": \"Smart shop\",\n      \"description\": \"Purchase Description\",\n      \"image\": \"https://cdn.razorpay.com/logos/H7uqY0rDp7E5mn_medium.png\",\n      \"handler\": function (response) {\n        swal({\n          title: \"Good job!\",\n          text: \"Payment successful, please refresh the page!\",\n          icon: \"success\",\n          button: \"Proceed!\",\n        });\n        //add to billing master \n        items.map(async (item) => {\n          var data = {\n            customer_id: uid,\n            item_code: item.item_code,\n            price: item.price,\n            product: item.product,\n            quantity: item.quantity,\n            sales_id: response.razorpay_payment_id\n          };\n          const ref = db.collection('branch item master').doc(String(item.item_code));\n          const document = await ref.get();\n          console.log(document.data().quantity_received);\n          var data1 = {\n            item_code: item.item_code,\n            price: item.price,\n            product: item.product,\n            quantity_received: document.data().quantity_received,\n            quantity_remaining: document.data().quantity_remaining - item.quantity\n          };\n          console.log(data);\n          console.log(data1 );\n\n          console.log(item.doc_id);\n          const ref1 = db.collection('billing master').doc();\n          const res = ref1.set(data);\n          const res1 = await db.collection('Cart').doc(String(item.doc_id)).delete();\n          const res2 = await db.collection('branch item master').doc(String(item.item_code)).set(data1);\n        })\n        addToSales(items);\n      },\n      \"prefill\": {\n        \"name\": \"\",\n        \"email\": \"\"\n      },\n      \"notes\": {\n        \"address\": \"Hello World\"\n      },\n      \"theme\": {\n        \"color\": \"#47A8BD\"\n      }\n    };\n\n    let rzp = new window.Razorpay(options);\n    rzp.open();\n  }\n  return <div>\n\n    <button class=\"btn transparent\" style={{ background: \"#6CB4EE\" }} id=\"rzp-button1\" onClick={() => openCheckout()}>\n      Pay\n      </button>\n  </div>\n\n}\nexport default RazorPanel;\n"]},"metadata":{},"sourceType":"module"}